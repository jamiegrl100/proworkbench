{
  "schemaVersion": 1,
  "id": "shell_commands",
  "name": "Shell Commands (Allowlisted)",
  "description": "Run allowlisted shell commands inside PB work directory.",
  "risk": "high",
  "allowedChannels": ["webchat"],
  "requiresApprovalByDefault": true,
  "fields": [
    { "key": "workdir", "label": "Working folder", "type": "path", "required": true, "defaultFrom": "PB_WORKDIR" },
    { "key": "commandAllowlistCsv", "label": "Allowed commands (comma separated)", "type": "csv", "required": true }
  ],
  "securityDefaults": {
    "workdirOnly": true,
    "pathAllowlist": ["{PB_WORKDIR}"],
    "domainAllowlist": [],
    "commandAllowlist": []
  }
}

